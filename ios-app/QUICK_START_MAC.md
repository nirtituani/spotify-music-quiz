# Quick Start Guide for Mac

Follow these steps to get the iOS app running on your Mac with Xcode.

## Prerequisites

- Mac with macOS 12.0+
- Xcode 14.0+ (from App Store)
- Node.js 18+ (`node --version`)
- CocoaPods (`pod --version`, install with `sudo gem install cocoapods`)
- Spotify Premium account
- Spotify Developer account

## Quick Setup (5 Steps)

### 1. Clone and Install

```bash
git clone https://github.com/YOUR_USERNAME/spotify-music-quiz.git
cd spotify-music-quiz/ios-app
npm install
cd ios
pod install
cd ..
```

### 2. Configure Spotify Developer Dashboard

1. Go to https://developer.spotify.com/dashboard
2. Create app (or use existing)
3. Add redirect URI: `spotifymusicquiz://callback`
4. Copy your Client ID

### 3. Add Client ID to Code

Edit `src/services/SpotifyAuthService.ts`:

```typescript
const spotifyAuthConfig: AuthConfiguration = {
  clientId: 'YOUR_CLIENT_ID_HERE', // ← Paste your Client ID
  // ...
};
```

### 4. Configure iOS Project (First Time Only)

You need to generate the iOS project structure first:

```bash
# Option A: Let React Native generate the iOS folder
npx react-native init SpotifyMusicQuizTemp
cp -r SpotifyMusicQuizTemp/ios ./ios
rm -rf SpotifyMusicQuizTemp

# Then follow IOS_NATIVE_CONFIG_NOTES.md to:
# - Edit Info.plist (add URL scheme)
# - Edit AppDelegate.mm (add deep linking)
# - Run pod install
```

See `IOS_NATIVE_CONFIG_NOTES.md` for detailed native configuration.

### 5. Build and Run

```bash
# On simulator (won't work with Spotify SDK - use for UI testing only)
npm run ios

# On physical device (REQUIRED for Spotify playback):
# 1. Connect iPhone via USB
# 2. Open ios/SpotifyMusicQuiz.xcworkspace in Xcode
# 3. Select your device
# 4. Press Cmd+R
```

## Important Notes

⚠️ **Physical Device Required**: Spotify SDK only works on real iPhone (not simulator)

⚠️ **Spotify App Required**: Install Spotify app from App Store on your device

⚠️ **URL Scheme**: Must be exactly `spotifymusicquiz` (no typos!)

⚠️ **Redirect URI**: Must match in code AND Spotify Dashboard: `spotifymusicquiz://callback`

## Testing Flow

1. Launch app on iPhone
2. Tap "Login with Spotify"
3. Safari opens → Authorize
4. Redirects back to app
5. Select playlist and duration
6. Tap "Start Round"
7. Music plays via Spotify app
8. Timer counts down
9. Song info revealed after timer/skip

## Troubleshooting

**"No Spotify app installed"**
- Install Spotify from App Store on your iPhone

**"Authentication failed"**
- Check Client ID in `SpotifyAuthService.ts`
- Verify redirect URI in Spotify Dashboard
- Check URL scheme in Xcode Info.plist

**"Pod install fails"**
```bash
cd ios
pod repo update
pod install
cd ..
```

**"Build failed in Xcode"**
```bash
cd ios
rm -rf Pods Podfile.lock
pod install
cd ..
```

## File Structure

```
ios-app/
├── src/
│   ├── services/
│   │   ├── SpotifyAuthService.ts    ← OAuth & token management
│   │   ├── SpotifyAPIService.ts     ← Backend API calls
│   │   └── SpotifyPlayerService.ts  ← Spotify SDK playback
│   ├── screens/
│   │   ├── LoginScreen.tsx          ← Login UI
│   │   └── GameScreen.tsx           ← Main game UI
│   └── types/
│       └── index.ts                 ← TypeScript types
├── ios/                             ← Generated by React Native
│   ├── Pods/                        ← CocoaPods dependencies
│   ├── SpotifyMusicQuiz/            ← Xcode project
│   │   ├── Info.plist              ← EDIT: Add URL scheme
│   │   └── AppDelegate.mm          ← EDIT: Add deep linking
│   └── SpotifyMusicQuiz.xcworkspace ← OPEN THIS in Xcode
├── App.tsx                          ← Main app entry
├── package.json                     ← Dependencies
└── IOS_SETUP_README.md             ← Full documentation
```

## Next Steps

After successful first build:

1. Test login flow
2. Test playlist selection
3. Test music playback
4. Test timer functionality
5. Polish UI and add animations
6. Add error handling
7. Test on multiple devices
8. Prepare for App Store (if desired)

## Resources

- Full documentation: `IOS_SETUP_README.md`
- Native config guide: `IOS_NATIVE_CONFIG_NOTES.md`
- Backend API: https://spotify-music-quiz.pages.dev
- Spotify docs: https://developer.spotify.com/documentation/ios

## Support

If you get stuck:

1. Check `IOS_SETUP_README.md` troubleshooting section
2. Check `IOS_NATIVE_CONFIG_NOTES.md` for native config
3. Verify all redirect URIs match exactly
4. Make sure Spotify app is installed on device
5. Check Xcode console for error messages
